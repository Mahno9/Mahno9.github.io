<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ë–∏–Ω–≥–æ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f5f5f5;
        }
        .bingo-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        .bingo-wrapper {
            position: relative;
            display: inline-block;
        }
        .bingo-image {
            width: 400px; /* Adjust based on actual image size */
            height: auto;
            display: block;
        }
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .block {
            position: absolute;
            width: 17%; /* Adjust to match the block size */
            height: 13%; /* Adjust to match the block size */
            background-color: transparent;
            cursor: pointer;
            border-radius: 5px;
            transition: background 0.2s ease;
        }
        /* Colors */
        .pink { background-color: rgba(255, 105, 180, 0.5); } /* Pink */
        .blue { background-color: rgba(100, 149, 237, 0.5); } /* Blue */
        .both { background: linear-gradient(45deg, rgba(255, 105, 180, 0.5), rgba(100, 149, 237, 0.5)); } /* Both Colors */
        
        .share-button {
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .share-button:hover {
            background-color: #45a049;
        }
        
        .share-url {
            margin: 15px auto;
            padding: 10px;
            width: 80%;
            max-width: 600px;
            display: none;
            font-size: 14px;
        }
        
        .compare-section {
            margin: 20px auto;
            padding: 15px;
            max-width: 600px;
            background-color: #f0f0f0;
            border-radius: 8px;
        }
        
        .compare-input {
            width: 80%;
            padding: 8px;
            margin-bottom: 10px;
        }
        
        .match-indicator {
            position: absolute;
            bottom: 5px;
            right: 5px;
            font-size: 20px;
            color: red;
            text-shadow: 1px 1px 2px white;
        }
        
        .match-highlight {
            box-shadow: 0 0 8px 2px gold;
        }
        
        .match-highlight-pink {
            box-shadow: 0 0 8px 2px hotpink;
        }
        
        .match-highlight-blue {
            box-shadow: 0 0 8px 2px cornflowerblue;
        }
    </style>
</head>
<body>

    <h1>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ë–∏–Ω–≥–æ</h1>
    <p>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —è—á–µ–π–∫–∏, —á—Ç–æ–±—ã –≤—ã–¥–µ–ª–∏—Ç—å –∏—Ö —Ü–≤–µ—Ç–æ–º.</p>
    
    <button id="shareButton" class="share-button">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º</button>
    <button id="resetAllButton" class="share-button" style="background-color: #ff5252; margin-left: 10px; display: inline-flex; align-items: center; justify-content: center;">
        <span style="margin-right: 5px;">Ô∏èüóëÔ∏è</span> –°–±—Ä–æ—Å–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ
    </button>
    <input type="text" id="shareUrl" class="share-url" readonly>
    
    <div class="compare-section">
        <h3>–°—Ä–∞–≤–Ω–∏—Ç—å —Å –¥—Ä—É–≥–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º</h3>
        <input type="text" id="compareUrl" class="compare-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ URL –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è">
        <button id="compareButton" class="share-button">–°—Ä–∞–≤–Ω–∏—Ç—å</button>
        <button id="resetMatchesButton" class="share-button" style="background-color: #ff5252; margin-left: 10px;">–°–±—Ä–æ—Å–∏—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è</button>
    </div>
    
    <div class="bingo-container" id="bingoContainer"></div>

    <button id="shareButtonBottom" class="share-button" style="margin-top: 30px;">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º</button>
    <input type="text" id="shareUrlBottom" class="share-url" readonly>
    
    <div style="margin-top: 20px; font-size: 14px; color: #666;">
        –ë–∏–Ω–≥–æ –≤–∑—è—Ç–æ –∏–∑ –¢–ì–ö: <a href="https://t.me/ruslanfrank48" target="_blank">@ruslanfrank48</a>
    </div>

    <script>
        const imageCount = 6; // Number of images (1.jpg to 6.jpg)
        const container = document.getElementById("bingoContainer");
        const positions = [
            { x: 9.8, y: 25 }, { x: 31, y: 25 }, { x: 52, y: 25 }, { x: 73, y: 25 }, 

			{ x: 9.8, y: 41.5 }, { x: 31, y: 41.5 }, { x: 52, y: 41.5 }, { x: 73, y: 41.5 }, 

            { x: 9.8, y: 58 }, { x: 31, y: 58 }, { x: 52, y: 58 }, { x: 73, y: 58 }, 

            { x: 9.8, y: 74.5 }, { x: 31, y: 74.5 }, { x: 52, y: 74.5 }, { x: 73, y: 74.5 }  
        ]; // Adjust based on block positions
        
        // –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let otherUserData = null;

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ URL
        function loadFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            const bingoData = urlParams.get('data');
            
            if (bingoData) {
                try {
                    const decodedData = JSON.parse(atob(bingoData));
                    
                    // –û—á–∏—â–∞–µ–º localStorage –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                    for (let i = 1; i <= imageCount; i++) {
                        for (let j = 0; j < positions.length; j++) {
                            localStorage.removeItem(`bingo-${i}-${j}`);
                        }
                    }
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ URL –≤ localStorage
                    Object.keys(decodedData).forEach(key => {
                        localStorage.setItem(key, decodedData[key]);
                    });
                } catch (e) {
                    console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–∑–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö URL:", e);
                }
            }
        }

        function loadImages() {
            // –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ URL, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
            loadFromUrl();
            
            for (let i = 1; i <= imageCount; i++) {
                const wrapper = document.createElement("div");
                wrapper.classList.add("bingo-wrapper");

                const img = document.createElement("img");
                img.src = `${i}.jpg`;
                img.classList.add("bingo-image");

                const overlay = document.createElement("div");
                overlay.classList.add("overlay");

                positions.forEach((pos, index) => {
                    const block = document.createElement("div");
                    block.classList.add("block");
                    block.style.left = `${pos.x}%`;
                    block.style.top = `${pos.y}%`;
                    block.dataset.bingoKey = `bingo-${i}-${index}`;

                    // Restore selection from localStorage
                    const key = `bingo-${i}-${index}`;
                    const savedState = localStorage.getItem(key);
                    if (savedState) block.classList.add(savedState);

                    block.addEventListener("click", () => toggleColor(block, key));

                    overlay.appendChild(block);
                });

                wrapper.appendChild(img);
                wrapper.appendChild(overlay);
                container.appendChild(wrapper);
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å–±—Ä–æ—Å–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
            document.querySelectorAll('.block').forEach(block => {
                block.addEventListener('click', function(e) {
                    // –ï—Å–ª–∏ –µ—Å—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è, —É–¥–∞–ª—è–µ–º –µ–≥–æ
                    const indicator = this.querySelector('.match-indicator');
                    if (indicator) {
                        indicator.remove();
                        this.classList.remove('match-highlight', 'match-highlight-pink', 'match-highlight-blue');
                        e.stopPropagation(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–ø–ª—ã—Ç–∏–µ, —á—Ç–æ–±—ã –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª toggleColor
                    }
                });
            });
        }

		function toggleColor(block, key) {
			if (block.classList.contains("pink") && block.classList.contains("blue")) {
				// If both colors are applied, clear everything
				block.classList.remove("pink", "blue", "both");
				localStorage.removeItem(key);
			} else if (block.classList.contains("pink")) {
				// If only pink is applied, switch to blue
				block.classList.remove("pink");
				block.classList.add("blue");
				localStorage.setItem(key, "blue");
			} else if (block.classList.contains("blue")) {
				// If only blue is applied, add pink (both colors)
				block.classList.add("pink");
				block.classList.add("both");
				localStorage.setItem(key, "both");
			} else {
				// If no color, start with pink
				block.classList.add("pink");
				localStorage.setItem(key, "pink");
			}
            
            // –ï—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ–±–Ω–æ–≤–ª—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
            if (otherUserData) {
                compareWithOtherData();
            }
		}
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è URL –¥–ª—è –æ–±–º–µ–Ω–∞
        function generateShareableUrl() {
            const bingoData = {};
            
            // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage, –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ –±–∏–Ω–≥–æ
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('bingo-')) {
                    bingoData[key] = localStorage.getItem(key);
                }
            }
            
            // –ö–æ–¥–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è URL
            const encodedData = btoa(JSON.stringify(bingoData));
            
            // –°–æ–∑–¥–∞–µ–º URL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º data
            const url = `${window.location.origin}${window.location.pathname}?data=${encodedData}`;
            
            return url;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ URL
        function extractDataFromUrl(url) {
            try {
                const urlObj = new URL(url);
                const bingoData = urlObj.searchParams.get('data');
                
                if (bingoData) {
                    return JSON.parse(atob(bingoData));
                }
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ URL:", e);
                alert("–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç URL –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è");
            }
            return null;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –¥–∞–Ω–Ω—ã–º–∏ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function compareWithOtherData() {
            // –û—á–∏—â–∞–µ–º –≤—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
            document.querySelectorAll('.match-indicator').forEach(el => el.remove());
            document.querySelectorAll('.match-highlight, .match-highlight-pink, .match-highlight-blue').forEach(el => {
                el.classList.remove('match-highlight', 'match-highlight-pink', 'match-highlight-blue');
            });
            
            if (!otherUserData) return;
            
            // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ –±–ª–æ–∫–∏
            document.querySelectorAll('.block').forEach(block => {
                const key = block.dataset.bingoKey;
                const myState = localStorage.getItem(key);
                const otherState = otherUserData[key];
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
                if (myState && otherState) {
                    let matchType = null;
                    
                    // –ú–æ–π —Ä–æ–∑–æ–≤—ã–π —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —á—É–∂–∏–º —Å–∏–Ω–∏–º –∏–ª–∏ –æ–±–æ–∏–º–∏
                    if ((myState === 'pink' || myState === 'both') && (otherState === 'blue' || otherState === 'both')) {
                        matchType = 'pink';
                    }
                    
                    // –ú–æ–π —Å–∏–Ω–∏–π —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —á—É–∂–∏–º —Ä–æ–∑–æ–≤—ã–º –∏–ª–∏ –æ–±–æ–∏–º–∏
                    if ((myState === 'blue' || myState === 'both') && (otherState === 'pink' || otherState === 'both')) {
                        matchType = matchType === 'pink' ? 'both' : 'blue';
                    }
                    
                    if (matchType) {
                        // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
                        const heart = document.createElement('div');
                        heart.classList.add('match-indicator');
                        // heart.innerHTML = '‚ù§Ô∏è';
                        block.appendChild(heart);
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É —Å –Ω—É–∂–Ω—ã–º —Ü–≤–µ—Ç–æ–º
                        if (matchType === 'pink') {
                            block.classList.add('match-highlight-pink');
                        } else if (matchType === 'blue') {
                            block.classList.add('match-highlight-blue');
                        } else if (matchType === 'both') {
                            block.classList.add('match-highlight');
                        }
                    }
                }
            });
        }
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" –≤–≤–µ—Ä—Ö—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.getElementById('shareButton').addEventListener('click', function() {
            shareResult('shareUrl');
        });
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" –≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.getElementById('shareButtonBottom').addEventListener('click', function() {
            shareResult('shareUrlBottom');
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
        document.getElementById('compareButton').addEventListener('click', function() {
            const compareUrl = document.getElementById('compareUrl').value;
            
            if (!compareUrl) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ URL –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è');
                return;
            }
            
            // –ò–∑–≤–ª–µ–∫–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ URL
            otherUserData = extractDataFromUrl(compareUrl);
            
            if (otherUserData) {
                compareWithOtherData();
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å–±—Ä–æ—Å–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
        document.getElementById('resetMatchesButton').addEventListener('click', function() {
            // –û—á–∏—â–∞–µ–º –≤—Å–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
            document.querySelectorAll('.match-indicator').forEach(el => el.remove());
            document.querySelectorAll('.match-highlight, .match-highlight-pink, .match-highlight-blue').forEach(el => {
                el.classList.remove('match-highlight', 'match-highlight-pink', 'match-highlight-blue');
            });
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å–±—Ä–æ—Å–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
        document.getElementById('resetAllButton').addEventListener('click', function() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
                // –û—á–∏—â–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –±–∏–Ω–≥–æ –∏–∑ localStorage
                for (let i = localStorage.length - 1; i >= 0; i--) {
                    const key = localStorage.key(i);
                    if (key.startsWith('bingo-')) {
                        localStorage.removeItem(key);
                    }
                }
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                document.querySelectorAll('.block').forEach(block => {
                    block.classList.remove('pink', 'blue', 'both');
                });
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π
                document.querySelectorAll('.match-indicator').forEach(el => el.remove());
                document.querySelectorAll('.match-highlight, .match-highlight-pink, .match-highlight-blue').forEach(el => {
                    el.classList.remove('match-highlight', 'match-highlight-pink', 'match-highlight-blue');
                });
                
                // –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–ª—è —Å URL
                document.getElementById('shareUrl').style.display = 'none';
                document.getElementById('shareUrlBottom').style.display = 'none';
                
                alert('–í—Å–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–±—Ä–æ—à–µ–Ω—ã!');
            }
        });
        
        // –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"
        function shareResult(targetInputId) {
            const shareUrl = document.getElementById(targetInputId);
            const url = generateShareableUrl();
            
            shareUrl.value = url;
            shareUrl.style.display = 'block';
            shareUrl.select();
            
            try {
                // –ü—ã—Ç–∞–µ–º—Å—è —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å URL –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
                document.execCommand('copy');
                alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            } catch (err) {
                console.error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å: ', err);
            }
        }

        loadImages();
    </script>

</body>
</html>
